effm_e1="or",
eff_e2=OR3,
effm_e2="or",
effm_ce = "or",
rho=0,alpha=alpha, beta=beta)
scenarios1 = expand_grid(p0_e1,p0_e2,OR1,OR2,corr_ce1,ss)
#
# p0_e1 = p0_ce1_corr
# p0_e2 = p0_e3
# OR1 = OR_ce1_corr
# OR2 = OR3
# corr_ce1 = "YES"
# ss = mapply(samplesize_cbe, p0_e1=p0_ce1_corr,
#             p0_e2=p0_e3,
#             eff_e1=OR_ce1_corr,
#             effm_e1="or",
#             eff_e2=OR3,
#             effm_e2="or",
#             effm_ce = "or",
#             rho=0,alpha=alpha, beta=beta)
#
# scenarios2 = expand_grid(p0_e1,p0_e2,OR1,OR2,corr_ce1,ss)
# scenarios=rbind(scenarios1,scenarios2)
scenarios=scenarios1
# Probabilities treat group
scenarios$p1_e1 = (scenarios$OR1*scenarios$p0_e1/(1-scenarios$p0_e1))/(1+(scenarios$OR1*scenarios$p0_e1/(1-scenarios$p0_e1)))
scenarios$p1_e2 = (scenarios$OR2*scenarios$p0_e2/(1-scenarios$p0_e2))/(1+(scenarios$OR2*scenarios$p0_e2/(1-scenarios$p0_e2)))
#
corr = c(0, 0.1, 0.2, 0.3, 0.4)
dataset = expand_grid(scenarios, corr)
# head(dataset)
#
# Calculate CE Probabilities
dataset$p0_ce = mapply(prob_cbe, p_e1=dataset$p0_e1, p_e2=dataset$p0_e2, rho=dataset$corr)
dataset$p1_ce = mapply(prob_cbe, p_e1=dataset$p1_e1, p_e2=dataset$p1_e2, rho=dataset$corr)
dataset$OR_ce = (dataset$p1_ce/(1-dataset$p1_ce))/(dataset$p0_ce/(1-dataset$p0_ce))
head(dataset)
dataset$Power<-c()
dataset$Power_CE<-c()
# dataset$Power_RE<-c()
dataset$decision<-c()
nsim=100000
# type i and ii errors
z.alpha <- qnorm(1-alpha,0,1)
z.beta <-  qnorm(1-beta,0,1)
for(i in 1:dim(dataset)[1]){
aux <- rowSums(replicate(nsim,eselectsim(ss_arm=round(dataset$ss[i]/2),
p0_e1=dataset$p0_e1[i],OR1=dataset$OR1[i],
p0_e2=dataset$p0_e2[i],OR2=dataset$OR2[i],
p0_ce=dataset$p0_ce[i],p_init=0.5,
criteria="SS",H0_e1=FALSE,H0_e2=FALSE,SS_r=TRUE))< c(-z.alpha,1))/nsim
dataset$Power[i]<- aux[1]
dataset$decision[i]<- 1-aux[2]
print(i)
}
for(i in 1:dim(dataset)[1]){
dataset$Power_CE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_ce[i],dataset$p1_ce[i]))< - z.alpha)/nsim
# dataset$Test_Power_RE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_e1[i],dataset$p0_e1[i]))< - z.alpha)/nsim
print(i)
}
summary(dataset)
source('C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/eselect/R/eselectsim.R')
######################################
# Power considerations
# Scenarios
p0_e1 = p0_ce1
p0_e2 = p0_e3
OR1 = OR_ce1
OR2 = OR3
corr_ce1 = "NO"
ss = mapply(samplesize_cbe, p0_e1=p0_ce1,
p0_e2=p0_e3,
eff_e1=OR_ce1,
effm_e1="or",
eff_e2=OR3,
effm_e2="or",
effm_ce = "or",
rho=0,alpha=alpha, beta=beta)
scenarios1 = expand_grid(p0_e1,p0_e2,OR1,OR2,corr_ce1,ss)
#
# p0_e1 = p0_ce1_corr
# p0_e2 = p0_e3
# OR1 = OR_ce1_corr
# OR2 = OR3
# corr_ce1 = "YES"
# ss = mapply(samplesize_cbe, p0_e1=p0_ce1_corr,
#             p0_e2=p0_e3,
#             eff_e1=OR_ce1_corr,
#             effm_e1="or",
#             eff_e2=OR3,
#             effm_e2="or",
#             effm_ce = "or",
#             rho=0,alpha=alpha, beta=beta)
#
# scenarios2 = expand_grid(p0_e1,p0_e2,OR1,OR2,corr_ce1,ss)
# scenarios=rbind(scenarios1,scenarios2)
scenarios=scenarios1
# Probabilities treat group
scenarios$p1_e1 = (scenarios$OR1*scenarios$p0_e1/(1-scenarios$p0_e1))/(1+(scenarios$OR1*scenarios$p0_e1/(1-scenarios$p0_e1)))
scenarios$p1_e2 = (scenarios$OR2*scenarios$p0_e2/(1-scenarios$p0_e2))/(1+(scenarios$OR2*scenarios$p0_e2/(1-scenarios$p0_e2)))
#
corr = c(0, 0.1, 0.2, 0.3, 0.4)
dataset = expand_grid(scenarios, corr)
# head(dataset)
#
# Calculate CE Probabilities
dataset$p0_ce = mapply(prob_cbe, p_e1=dataset$p0_e1, p_e2=dataset$p0_e2, rho=dataset$corr)
dataset$p1_ce = mapply(prob_cbe, p_e1=dataset$p1_e1, p_e2=dataset$p1_e2, rho=dataset$corr)
dataset$OR_ce = (dataset$p1_ce/(1-dataset$p1_ce))/(dataset$p0_ce/(1-dataset$p0_ce))
head(dataset)
dataset$Power<-c()
dataset$Power_CE<-c()
# dataset$Power_RE<-c()
dataset$decision<-c()
nsim=100000
# type i and ii errors
z.alpha <- qnorm(1-alpha,0,1)
z.beta <-  qnorm(1-beta,0,1)
for(i in 1:dim(dataset)[1]){
aux <- rowSums(replicate(nsim,eselectsim(ss_arm=round(dataset$ss[i]/2),
p0_e1=dataset$p0_e1[i],OR1=dataset$OR1[i],
p0_e2=dataset$p0_e2[i],OR2=dataset$OR2[i],
p0_ce=dataset$p0_ce[i],p_init=0.5,
criteria="SS",H0_e1=FALSE,H0_e2=FALSE,SS_r=TRUE))< c(-z.alpha,1))/nsim
dataset$Power[i]<- aux[1]
dataset$decision[i]<- 1-aux[2]
print(i)
}
for(i in 1:dim(dataset)[1]){
dataset$Power_CE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_ce[i],dataset$p1_ce[i]))< - z.alpha)/nsim
# dataset$Test_Power_RE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_e1[i],dataset$p0_e1[i]))< - z.alpha)/nsim
print(i)
}
summary(dataset)
source('C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/eselect/R/eselect.R')
######################################
# Power considerations
# Scenarios
p0_e1 = p0_ce1
p0_e2 = p0_e3
OR1 = OR_ce1
OR2 = OR3
corr_ce1 = "NO"
ss = mapply(samplesize_cbe, p0_e1=p0_ce1,
p0_e2=p0_e3,
eff_e1=OR_ce1,
effm_e1="or",
eff_e2=OR3,
effm_e2="or",
effm_ce = "or",
rho=0,alpha=alpha, beta=beta)
scenarios1 = expand_grid(p0_e1,p0_e2,OR1,OR2,corr_ce1,ss)
#
# p0_e1 = p0_ce1_corr
# p0_e2 = p0_e3
# OR1 = OR_ce1_corr
# OR2 = OR3
# corr_ce1 = "YES"
# ss = mapply(samplesize_cbe, p0_e1=p0_ce1_corr,
#             p0_e2=p0_e3,
#             eff_e1=OR_ce1_corr,
#             effm_e1="or",
#             eff_e2=OR3,
#             effm_e2="or",
#             effm_ce = "or",
#             rho=0,alpha=alpha, beta=beta)
#
# scenarios2 = expand_grid(p0_e1,p0_e2,OR1,OR2,corr_ce1,ss)
# scenarios=rbind(scenarios1,scenarios2)
scenarios=scenarios1
# Probabilities treat group
scenarios$p1_e1 = (scenarios$OR1*scenarios$p0_e1/(1-scenarios$p0_e1))/(1+(scenarios$OR1*scenarios$p0_e1/(1-scenarios$p0_e1)))
scenarios$p1_e2 = (scenarios$OR2*scenarios$p0_e2/(1-scenarios$p0_e2))/(1+(scenarios$OR2*scenarios$p0_e2/(1-scenarios$p0_e2)))
#
corr = c(0, 0.1, 0.2, 0.3, 0.4)
dataset = expand_grid(scenarios, corr)
# head(dataset)
#
# Calculate CE Probabilities
dataset$p0_ce = mapply(prob_cbe, p_e1=dataset$p0_e1, p_e2=dataset$p0_e2, rho=dataset$corr)
dataset$p1_ce = mapply(prob_cbe, p_e1=dataset$p1_e1, p_e2=dataset$p1_e2, rho=dataset$corr)
dataset$OR_ce = (dataset$p1_ce/(1-dataset$p1_ce))/(dataset$p0_ce/(1-dataset$p0_ce))
head(dataset)
dataset$Power<-c()
dataset$Power_CE<-c()
# dataset$Power_RE<-c()
dataset$decision<-c()
nsim=100000
# type i and ii errors
z.alpha <- qnorm(1-alpha,0,1)
z.beta <-  qnorm(1-beta,0,1)
for(i in 1:dim(dataset)[1]){
aux <- rowSums(replicate(nsim,eselectsim(ss_arm=round(dataset$ss[i]/2),
p0_e1=dataset$p0_e1[i],OR1=dataset$OR1[i],
p0_e2=dataset$p0_e2[i],OR2=dataset$OR2[i],
p0_ce=dataset$p0_ce[i],p_init=0.5,
criteria="SS",H0_e1=FALSE,H0_e2=FALSE,SS_r=TRUE))< c(-z.alpha,1))/nsim
dataset$Power[i]<- aux[1]
dataset$decision[i]<- 1-aux[2]
print(i)
}
for(i in 1:dim(dataset)[1]){
dataset$Power_CE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_ce[i],dataset$p1_ce[i]))< - z.alpha)/nsim
# dataset$Test_Power_RE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_e1[i],dataset$p0_e1[i]))< - z.alpha)/nsim
print(i)
}
summary(dataset)
dataset$pe <- ifelse(dataset$decision>1,"RE","CE")
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE),
Design=c(rep("AD",length(dataset$Power)),
rep("CE",length(dataset$Power_CE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr)
)
power_data$Design <- as.factor(power_data$Design)
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design, linetype = Correlation)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
save.image("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/CODE_paper/example/example_power.RData")
# + labs(color = "Decision\n", linetype = "Correlation\n")
# # + ylab("Sample size")
ggsave("example_power_s.pdf",width = 100, height = 100, units = "mm")
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
# + labs(color = "Decision\n", linetype = "Correlation\n")
# # + ylab("Sample size")
ggsave("example_power_s.pdf",width = 100, height = 100, units = "mm")
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Endpoint#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")
ggsave("example_s.pdf",width = 100, height = 100, units = "mm")
for(i in 1:dim(dataset)[1]){
dataset$Power_CE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_ce[i],dataset$p1_ce[i]))< - z.alpha)/nsim
dataset$Test_Power_RE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_e1[i],dataset$p1_e1[i]))< - z.alpha)/nsim
print(i)
}
dataset$Power_RE<-c()
for(i in 1:dim(dataset)[1]){
dataset$Power_CE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_ce[i],dataset$p1_ce[i]))< - z.alpha)/nsim
dataset$Test_Power_RE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_e1[i],dataset$p1_e1[i]))< - z.alpha)/nsim
print(i)
}
summary(dataset)
dataset$pe <- ifelse(dataset$decision>1,"RE","CE")
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE,dataset$Power_RE),
Design=c(rep("AD",length(dataset$Power)),
rep("CE",length(dataset$Power_CE)),
rep("RE",length(dataset$Power_RE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr,dataset$corr)
)
power_data$Design <- as.factor(power_data$Design)
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
summary(dataset)
dataset$pe <- ifelse(dataset$decision>1,"RE","CE")
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE,dataset$Power_RE),
Design=c(rep("AD",length(dataset$Power)),
rep("CE",length(dataset$Power_CE)),
rep("RE",length(dataset$Power_RE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr,dataset$corr)
)
head(power_data)
View(power_data)
dataset$Power_RE<-c()
for(i in 1:dim(dataset)[1]){
dataset$Power_CE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_ce[i],dataset$p1_ce[i]))< - z.alpha)/nsim
dataset$Power_RE[i] <- sum(replicate(nsim,f_OR(dataset$ss[i]/2,dataset$p0_e1[i],dataset$p1_e1[i]))< - z.alpha)/nsim
print(i)
}
summary(dataset)
dataset$pe <- ifelse(dataset$decision>1,"RE","CE")
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE,dataset$Power_RE),
Design=c(rep("AD",length(dataset$Power)),
rep("CE",length(dataset$Power_CE)),
rep("RE",length(dataset$Power_RE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr,dataset$corr)
)
power_data$Design <- as.factor(power_data$Design)
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
power_data$Design <- as.factor(power_data$Design, levels=c("CD","RD","AD"))
power_data$Design <- factor(power_data$Design, levels=c("CD","RD","AD"))
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE,dataset$Power_RE),
Design=c(rep("AD",length(dataset$Power)),
rep("CD",length(dataset$Power_CE)),
rep("RD",length(dataset$Power_RE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr,dataset$corr)
)
power_data$Design <- factor(power_data$Design, levels=c("CD","RD","AD"))
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Endpoint#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")
# ss_cbe_corr <- mapply(samplesize_cbe, p0_e1=p0_ce1_corr,
#                  p0_e2=p0_e3,
#                  eff_e1=OR_ce1_corr,
#                  effm_e1="or",
#                  eff_e2=OR3,
#                  effm_e2="or",
#                  effm_ce = "or",
#                  rho=c(0,0.1,0.2,0.3,0.4),alpha=alpha, beta=beta)
#
data_plot_simpl = data.frame(ss=c(ss_cbe,
rep(n1,length(ss_cbe))
# ,
# rep(n1_corr,length(ss_cbe))
),
rho=rep(rho,2),
Endpoint=c(rep("CD",length(ss_cbe)),rep("RD",length(ss_cbe))
)
# ,
# Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
# )
)
# ss_cbe_corr <- mapply(samplesize_cbe, p0_e1=p0_ce1_corr,
#                  p0_e2=p0_e3,
#                  eff_e1=OR_ce1_corr,
#                  effm_e1="or",
#                  eff_e2=OR3,
#                  effm_e2="or",
#                  effm_ce = "or",
#                  rho=c(0,0.1,0.2,0.3,0.4),alpha=alpha, beta=beta)
#
data_plot_simpl = data.frame(ss=c(ss_cbe,
rep(n1,length(ss_cbe))
# ,
# rep(n1_corr,length(ss_cbe))
),
rho=rep(rho,2),
Endpoint=c(rep("CD",length(ss_cbe)),rep("RD",length(ss_cbe))
)
# ,
# Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
# )
)
#                             ss_cbe_corr,
#                             rep(n1,length(ss_cbe)),
#                             rep(n1_corr,length(ss_cbe))),
#                        rho=rep(rho,4),
#                        Endpoint=c(rep("CE",2*length(ss_cbe)),rep("RE",2*length(ss_cbe))
#                              ),
#                        Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#                               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
#                               )
#                        )
data_plot_simpl$Endpoint = factor(data_plot_simpl$Endpoint,levels=c("CD","RD"))
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Endpoint#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE,dataset$Power_RE),
Design=c(rep("AD",length(dataset$Power)),
rep("CD",length(dataset$Power_CE)),
rep("RD",length(dataset$Power_RE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr,dataset$corr)
)
power_data$Design <- factor(power_data$Design, levels=c("CD","RD","AD"))
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
# ss_cbe_corr <- mapply(samplesize_cbe, p0_e1=p0_ce1_corr,
#                  p0_e2=p0_e3,
#                  eff_e1=OR_ce1_corr,
#                  effm_e1="or",
#                  eff_e2=OR3,
#                  effm_e2="or",
#                  effm_ce = "or",
#                  rho=c(0,0.1,0.2,0.3,0.4),alpha=alpha, beta=beta)
#
data_plot_simpl = data.frame(ss=c(ss_cbe,
rep(n1,length(ss_cbe))
# ,
# rep(n1_corr,length(ss_cbe))
),
rho=rep(rho,2),
Design=c(rep("CD",length(ss_cbe)),rep("RD",length(ss_cbe))
)
# ,
# Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
# )
)
#                             ss_cbe_corr,
#                             rep(n1,length(ss_cbe)),
#                             rep(n1_corr,length(ss_cbe))),
#                        rho=rep(rho,4),
#                        Endpoint=c(rep("CE",2*length(ss_cbe)),rep("RE",2*length(ss_cbe))
#                              ),
#                        Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#                               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
#                               )
#                        )
data_plot_simpl$Endpoint = factor(data_plot_simpl$Endpoint,levels=c("CD","RD"))
#                             ss_cbe_corr,
#                             rep(n1,length(ss_cbe)),
#                             rep(n1_corr,length(ss_cbe))),
#                        rho=rep(rho,4),
#                        Endpoint=c(rep("CE",2*length(ss_cbe)),rep("RE",2*length(ss_cbe))
#                              ),
#                        Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#                               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
#                               )
#                        )
data_plot_simpl$Design = factor(data_plot_simpl$Endpoint,levels=c("CD","RD"))
#                             ss_cbe_corr,
#                             rep(n1,length(ss_cbe)),
#                             rep(n1_corr,length(ss_cbe))),
#                        rho=rep(rho,4),
#                        Endpoint=c(rep("CE",2*length(ss_cbe)),rep("RE",2*length(ss_cbe))
#                              ),
#                        Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#                               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
#                               )
#                        )
data_plot_simpl$Design = factor(data_plot_simpl$Design,levels=c("CD","RD"))
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Endpoint#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")
#                             ss_cbe_corr,
#                             rep(n1,length(ss_cbe)),
#                             rep(n1_corr,length(ss_cbe))),
#                        rho=rep(rho,4),
#                        Endpoint=c(rep("CE",2*length(ss_cbe)),rep("RE",2*length(ss_cbe))
#                              ),
#                        Correlation=c(rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe)),
#                               rep("NO",length(ss_cbe)),rep("YES",length(ss_cbe))
#                               )
#                        )
data_plot_simpl$Design = factor(data_plot_simpl$Design,levels=c("CD","RD"))
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")
ggsave("example_s.pdf",width = 100, height = 100, units = "mm")
dataset$pe <- ifelse(dataset$decision>1,"RE","CE")
#
power_data <- data.frame(Power=c(dataset$Power,dataset$Power_CE,dataset$Power_RE),
Design=c(rep("AD",length(dataset$Power)),
rep("CD",length(dataset$Power_CE)),
rep("RD",length(dataset$Power_RE))),
Correlation=c(dataset$corr_ce1,dataset$corr_ce1,dataset$corr_ce1),
corr=c(dataset$corr,dataset$corr,dataset$corr)
)
power_data$Design <- factor(power_data$Design, levels=c("CD","RD","AD"))
power_data$Correlation <- as.factor(power_data$Correlation)
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85))
# + labs(color = "Decision\n", linetype = "Correlation\n")
# # + ylab("Sample size")
ggsave("example_power_s.pdf",width = 100, height = 100, units = "mm")
save.image("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/CODE_paper/example/example_power.RData")
+ scale_fill_manual(breaks = c("CD","RD","AD"),
values=c("red", "blue", "green"))
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85)) + scale_fill_manual(breaks = c("CD","RD","AD"),
values=c("red", "blue", "green"))
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85)) + scale_fill_manual(breaks = c("CD","RD","AD"), values=c("red", "blue", "green"))
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85)) + scale_color_manual(breaks = c("CD","RD","AD"), values=c("red", "blue", "green"))
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85)) + scale_color_manual(breaks = c("CD","RD","AD"), values=c("#D9717D", "#4DB6D0", "#BECA55"))
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")  + scale_color_manual(breaks = c("CD","RD"), values=c("#D9717D", "#4DB6D0"))
ggplot(data_plot_simpl,aes(x = rho, y = ss, color=Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylab("Sample size")  + scale_color_manual(breaks = c("CD","RD"), values=c("#D9717D", "#4DB6D0"))
ggsave("example_s.pdf",width = 100, height = 100, units = "mm")
#
# #
ggplot(power_data,aes(x = corr, y = Power, color = Design#, linetype = Correlation
)) + geom_point() +geom_line(size=0.8) + xlab("Correlation") + ylim(c(0.7,0.85)) + scale_color_manual(breaks = c("CD","RD","AD"), values=c("#D9717D", "#4DB6D0", "#BECA55"))
# + labs(color = "Decision\n", linetype = "Correlation\n")
# # + ylab("Sample size")
ggsave("example_power_s.pdf",width = 100, height = 100, units = "mm")
