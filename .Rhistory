geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
# + geom_point()+ geom_path()
# p[[enum+2]] <-ggplot(sub, aes(x=corr, y=Test_Power_CE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
# p[[enum+3]] <-ggplot(sub, aes(x=corr, y=Test_Power_RE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=5,top=NULL)
# l = mget(plot)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
# + geom_point()+ geom_path()
# p[[enum+2]] <-ggplot(sub, aes(x=corr, y=Test_Power_CE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
# p[[enum+3]] <-ggplot(sub, aes(x=corr, y=Test_Power_RE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
# l = mget(plot)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
#
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2),legend.title = element_text(size = 8), legend.text = element_text(size = 8))
# + geom_point()+ geom_path()
# p[[enum+2]] <-ggplot(sub, aes(x=corr, y=Test_Power_CE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
# p[[enum+3]] <-ggplot(sub, aes(x=corr, y=Test_Power_RE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
# l = mget(plot)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2),legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + geom_point()+ geom_path()
# p[[enum+2]] <-ggplot(sub, aes(x=corr, y=Test_Power_CE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
# p[[enum+3]] <-ggplot(sub, aes(x=corr, y=Test_Power_RE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
#
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom",#legend.position = c(0.8, 0.2),
legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + geom_point()+ geom_path()
# p[[enum+2]] <-ggplot(sub, aes(x=corr, y=Test_Power_CE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
# p[[enum+3]] <-ggplot(sub, aes(x=corr, y=Test_Power_RE))  +
#   geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
#
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom",#legend.position = c(0.8, 0.2),
legend.title = element_text(size = 6), legend.text = element_text(size = 6))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0True_e1.RData")
##################################################################################
# Results under H1 - Study on the power
##################################################################################
rm(list = ls())
# Under H1
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0True_e1.RData")
dataset_H0False_ss = dataset
rm(dataset)
#
summary(dataset_H0False_ss)
#
power_data <- data.frame(Power=c(dataset_H0False_ss$Test_Power_ES_SS,dataset_H0False_ss$Test_Power_ES_ubSS,
dataset_H0False_ss$Test_Power_CE,dataset_H0False_ss$Test_Power_RE),
Endpoint=c(rep("SE",length(dataset_H0False_ss$Test_Power_ES_SS)),
rep("SE_ub",length(dataset_H0False_ss$Test_Power_ES_ubSS)),
rep("CE",length(dataset_H0False_ss$Test_Power_CE)),
rep("RE",length(dataset_H0False_ss$Test_Power_RE)))
)
ggplot(power_data, aes(x=Endpoint, y=Power)) + geom_boxplot()
##################################################################################
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
ggsave(file="whatever2.pdf", plot, width = 210, height = 297, units = "mm")
##################################################################################
# Results under H1 - Study on the power
##################################################################################
rm(list = ls())
# Under H1
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0True_e2.RData")
dataset_H0False_ss = dataset
rm(dataset)
#
summary(dataset_H0False_ss)
#
power_data <- data.frame(Power=c(dataset_H0False_ss$Test_Power_ES_SS,dataset_H0False_ss$Test_Power_ES_ubSS,
dataset_H0False_ss$Test_Power_CE,dataset_H0False_ss$Test_Power_RE),
Endpoint=c(rep("SE",length(dataset_H0False_ss$Test_Power_ES_SS)),
rep("SE_ub",length(dataset_H0False_ss$Test_Power_ES_ubSS)),
rep("CE",length(dataset_H0False_ss$Test_Power_CE)),
rep("RE",length(dataset_H0False_ss$Test_Power_RE)))
)
ggplot(power_data, aes(x=Endpoint, y=Power)) + geom_boxplot()
##################################################################################
p <- list()
enum = 1
it <- 1
for(i in 1:max(dataset_H0False_ss$scenario)){
sub=subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i & dataset_H0False_ss$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_ubSS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES, unblinded)", x="Correlation", color="Decision SS") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
p[[enum+2]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset_H0False_ss$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset_H0False_ss$p0_e1[it],",",dataset_H0False_ss$p0_e2[it],",",dataset_H0False_ss$OR1[it],",",dataset_H0False_ss$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Decision") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 6), legend.text = element_text(size = 6))
stable <- data.frame(Corr=sub$corr,
SS=round(sub$ss_ratio,2),"%CE"=round(100*sub$decision_ES_SS,2),
"%CE_u"=round(100*sub$decision_ES_ubSS,2),check.names=FALSE)
p[[enum+3]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+4
it <- it + dim(subset(dataset_H0False_ss,dataset_H0False_ss$scenario==i))
}
plot <- marrangeGrob(p,ncol=3,nrow=4,top=NULL)
ggsave(file="whatever2.pdf", plot, width = 210, height = 297, units = "mm")
##################################################################################
# Effect only on the relevant endpoint
##################################################################################
rm(list = ls())
# Under H1
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0False.RData")
View(dataset)
rm(list = ls())
library(ggplot2)
library(gridExtra)
library(ggpubr)
library(tidyverse)
#
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0False_withss.RData")
summary(dataset)
# dataset=dataset[dataset$p_init==0.5,]
power_data <- data.frame(Power=c(dataset$Test_Power_ES_SS,
dataset$Test_Power_CE,dataset$Test_Power_RE),
Endpoint=c(rep("Selected Endpoint",length(dataset$Test_Power_ES_SS)),
rep("Composite Endpoint",length(dataset$Test_Power_CE)),
rep("Relevant Endpoint",length(dataset$Test_Power_RE)))
)
ggplot_ss <- ggplot(power_data, aes(x=Endpoint, y=Power)) + geom_boxplot()
windows()
ggplot_ss
##################################################################################
p <- list()
enum = 1
it <- 1
i=1
# for(i in 1:max(dataset$scenario)){
sub=subset(dataset,dataset$scenario==i & dataset$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
p[[enum+1]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(univ$testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
stable <- data.frame("Correlation"=sub$corr,
"Decision rule"=round(sub$ss_ratio,2),"% Composite Endpoint"=round(100*sub$decision_ES_SS,2),check.names=FALSE)
p[[enum+2]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+3
it <- it + dim(subset(dataset,dataset$scenario==i))
# }
plot <- marrangeGrob(p,ncol=3,nrow=1,top=NULL)
# ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
windows()
plot
#
##################################################################################
p <- list()
enum = 1
it <- 1
i=1
# for(i in 1:max(dataset$scenario)){
sub=subset(dataset,dataset$scenario==i & dataset$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
#
p[[enum+1]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(univ$testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
stable <- data.frame("Correlation"=sub$corr,
"Decision rule"=round(sub$ss_ratio,2),"% Composite Endpoint"=round(100*sub$decision_ES_SS,2),check.names=FALSE)
p[[enum+2]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+3
it <- it + dim(subset(dataset,dataset$scenario==i))
# }
plot <- marrangeGrob(p,ncol=3,nrow=1,top=NULL)
##################################################################################
p <- list()
enum = 1
it <- 1
i=1
# for(i in 1:max(dataset$scenario)){
sub=subset(dataset,dataset$scenario==i & dataset$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
#
p[[enum]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
#
p[[enum+1]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
stable <- data.frame("Correlation"=sub$corr,
"Decision rule"=round(sub$ss_ratio,2),"% Composite Endpoint"=round(100*sub$decision_ES_SS,2),check.names=FALSE)
p[[enum+2]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+3
it <- it + dim(subset(dataset,dataset$scenario==i))
# }
plot <- marrangeGrob(p,ncol=3,nrow=1,top=NULL)
# ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
windows()
plot
##################################################################################
p <- list()
enum = 1
it <- 1
i=1
# for(i in 1:max(dataset$scenario)){
sub=subset(dataset,dataset$scenario==i & dataset$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
# CE/RE
p[[enum]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
# ES
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
stable <- data.frame("Correlation"=sub$corr,
"Decision rule"=round(sub$ss_ratio,2),"% Composite Endpoint"=round(100*sub$decision_ES_SS,2),check.names=FALSE)
p[[enum+2]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+3
it <- it + dim(subset(dataset,dataset$scenario==i))
# }
plot <- marrangeGrob(p,ncol=3,nrow=1,top=NULL)
# ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
windows()
plot
############################################################################
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/20210-12-03b-with ARE/results/results_H0False_withoutss_new.RData")
power_data <- data.frame(Power=c(dataset$Test_Power_ES_SS,
dataset$Test_Power_CE,dataset$Test_Power_RE),
Endpoint=c(rep("Selected Endpoint",length(dataset$Test_Power_ES_SS)),
rep("Composite Endpoint",length(dataset$Test_Power_CE)),
rep("Relevant Endpoint",length(dataset$Test_Power_RE)))
)
ggplot_ss <- ggplot(power_data, aes(x=Endpoint, y=Power)) + geom_boxplot()
windows()
ggplot_ss
###############################################################
p <- list()
enum = 1
it <- 1
i=1
# for(i in 1:max(dataset$scenario)){
sub=subset(dataset,dataset$scenario==i & dataset$p_init==1.0)
univ=rbind(sub,sub)
univ$testind=c(rep("RE",dim(sub)[1]),rep("CE",dim(sub)[1]))
univ$test=ifelse(univ$testind=="RE",univ$Test_Power_RE,univ$Test_Power_CE)
# CE/RE
p[[enum]] <- ggplot(univ, aes(x=corr, y=test, color=as.factor(univ$testind)))+
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (CE/RE)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
# SE
p[[enum+1]] <-ggplot(sub, aes(x=corr, y=Test_Power_ES_SS, color=as.factor(ss_decision)))  +
geom_point(size=2)+ ggtitle(paste("Scenario", dataset$scenario[it], "\n (p1,p2,OR1,OR2) \n=(", dataset$p0_e1[it],",",dataset$p0_e2[it],",",dataset$OR1[it],",",dataset$OR2[it],")"))+geom_point(size=2)  + labs(y = "Empirical Power (ES)", x="Correlation", color="Endpoint") + coord_cartesian(ylim = c(0.60, 1))+ geom_path()+ theme(plot.title = element_text(size=9),legend.position="bottom", legend.title = element_text(size = 8), legend.text = element_text(size = 6))
# + theme(plot.title = element_text(size=9),legend.position = c(0.8, 0.2))
stable <- data.frame("Correlation"=sub$corr,
"Decision rule"=round(sub$ss_ratio,2),"% Composite Endpoint"=round(100*sub$decision_ES_SS,2),check.names=FALSE)
p[[enum+2]] <- ggtexttable(stable, rows = NULL, theme = ttheme(base_style = "default", base_size = 9))
enum=enum+3
it <- it + dim(subset(dataset,dataset$scenario==i))
# }
plot <- marrangeGrob(p,ncol=3,nrow=1,top=NULL)
# ggsave(file="whatever.pdf", plot, width = 210, height = 297, units = "mm")
windows()
plot
# Under H0
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0True.RData")
dataset_H0True = dataset
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES"] <- 'Test_Reject_ES'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES_SS"] <- 'Test_Reject_ES_SS'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES_ub"] <- 'Test_Reject_ES_ub'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES_ubSS"] <- 'Test_Reject_ES_ubSS'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_CE"] <- 'Test_Reject_CE'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_RE"] <- 'Test_Reject_RE'
signlevel_data <- data.frame(signlevel=c(dataset_H0True$Test_Reject_ES_SS,
dataset_H0True$Test_Reject_ES_ubSS,
dataset_H0True$Test_Reject_CE,dataset_H0True$Test_Reject_RE),
Endpoint=c(rep("SE (blinded)",length(dataset_H0True$Test_Reject_ES_SS)),
rep("SE (unblinded)",length(dataset_H0True$Test_Reject_ES_ubSS)),
rep("CE",length(dataset_H0True$Test_Reject_CE)),
rep("RE",length(dataset_H0True$Test_Reject_RE)))
)
ggplot(signlevel_data, aes(x=Endpoint, y=signlevel)) + geom_boxplot() + labs(y = "Significance level", x="Endpoint")
subset_h0 <- data.frame(Test_Reject_ES_SS=dataset_H0True$Test_Reject_ES_SS,
Test_Reject_ES_ubSS=dataset_H0True$Test_Reject_ES_ubSS,
Test_Reject_CE=dataset_H0True$Test_Reject_CE,
Test_Reject_RE=dataset_H0True$Test_Reject_RE
)
summary(subset_h0)
ggplot(signlevel_data, aes(x=Endpoint, y=signlevel)) + geom_boxplot() + labs(y = "Significance level", x="Endpoint")
rm(list = ls())
library(ggplot2)
library(gridExtra)
library(ggpubr)
library(tidyverse)
##################################################################################
# Results under H0 - Study on the significance level
##################################################################################
# Under H0
load("C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/results/results_H0True.RData")
dataset_H0True = dataset
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES"] <- 'Test_Reject_ES'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES_SS"] <- 'Test_Reject_ES_SS'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES_ub"] <- 'Test_Reject_ES_ub'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_ES_ubSS"] <- 'Test_Reject_ES_ubSS'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_CE"] <- 'Test_Reject_CE'
names(dataset_H0True)[names(dataset_H0True)=="Test_Power_RE"] <- 'Test_Reject_RE'
signlevel_data <- data.frame(signlevel=c(dataset_H0True$Test_Reject_ES_SS,
dataset_H0True$Test_Reject_ES_ubSS,
dataset_H0True$Test_Reject_CE,dataset_H0True$Test_Reject_RE),
Endpoint=c(rep("SE (blinded)",length(dataset_H0True$Test_Reject_ES_SS)),
rep("SE (unblinded)",length(dataset_H0True$Test_Reject_ES_ubSS)),
rep("CE",length(dataset_H0True$Test_Reject_CE)),
rep("RE",length(dataset_H0True$Test_Reject_RE)))
)
ggplot(signlevel_data, aes(x=Endpoint, y=signlevel)) + geom_boxplot() + labs(y = "Significance level", x="Endpoint")
subset_h0 <- data.frame(Test_Reject_ES_SS=dataset_H0True$Test_Reject_ES_SS,
Test_Reject_ES_ubSS=dataset_H0True$Test_Reject_ES_ubSS,
Test_Reject_CE=dataset_H0True$Test_Reject_CE,
Test_Reject_RE=dataset_H0True$Test_Reject_RE
)
summary(subset_h0)
source('C:/Users/mbofi/Dropbox/C5/Scripts/GitKraken/CBE_selection/eselect/R/eselectsim.R')
View(eselectsim)
View(eselect)
View(eselect)
View(eselect)
View(eselect_ub)
View(eselectsim_ub)
View(eselectsim)
