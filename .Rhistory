sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = p1_ce-p1_e2 #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = p1_ce-p1_e1 #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=1000
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = p1_ce-p1_e2 #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = p1_ce-p1_e1 #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
dataset[i,]
p1_ce-p1_e2
ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0)
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=1000
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0) #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)  #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=1000
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0) #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)  #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=1000
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0) #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)  #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=1000
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0) #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)  #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=1000
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0) #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)  #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
sm0
sm1
(sm0+sm1)
sm = (sm0+sm1)
corr_est =(sm[1]*sm[4]-(sm[2]*sm[3]))/sqrt((sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4]))
sm
sqrt((sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4]))
sm[1]
sm[3]
sm[2]
sm[4]
sm[1]
+sm[2]
sm[3]
+sm[4]
(sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4])
sm = (sm0+sm1)
corr_est =(sm[1]*sm[4]-(sm[2]*sm[3]))/sqrt((sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4]))
(corr_est)
sm
sm[1]+sm[3]
sm[2]+sm[4]
sm[1]+sm[2]
sm[3]+sm[4]
(sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4])
(sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])
samplesize=500
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
samplesize=500
# dataset$corr[i]
dataset[i,]
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2 #p0_e1 - (p0_e1+p0_e2-p0_ce)
s3_group0 = p0_ce-p0_e1 #p0_e2 - (p0_e1+p0_e2-p0_ce)
s4_group0 = 1- p0_ce #1 - s1_group0 - s2_group0 - s3_group0
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0) #p1_e1 - (p1_e1+p1_e2-p1_ce)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)  #p1_e2 - (p1_e1+p1_e2-p1_ce)
s4_group1 = 1- p1_ce # 1 - s1_group1 - s2_group1 - s3_group1
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
sm = (sm0+sm1)
corr_est =(sm[1]*sm[4]-(sm[2]*sm[3]))/sqrt((sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4]))
(corr_est)
(sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4])
(sm[1]+sm[3])
(sm[2]+sm[4])
(sm[1]+sm[2])
(sm[3]+sm[4])
(sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4])
OR1 =dataset$OR1
p=p1_e1+p0_e1
l=OR1
-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
OR1 =dataset$OR1[i]
samplesize=500
p=p1_e1+p0_e1
l=OR1
-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
OR1
-(1 + l + p - l*p - sqrt(4 (-1 + l)*p + (1 + l + p - l p)^2))/(2*(-1 + l))
-(1 + l + p - l*p - sqrt(4 (-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
-(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
1/-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
1/(-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l)))
-(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
p=p1_e1+p0_e1
l=OR1
-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
-(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
p1_e1
p0_e1
-(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
-(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
-(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
fun_p0 <- function(p,l){
sol1= -(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
sol2= -(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
if(sol2>0 & sol2<1){
p0=sol2
}else{
p0=sol1
}
return(p0)
}
p=p1_e1+p0_e1
l=OR1
fun_p0(p=p,l=l)
sm
sm[1]
sm[2]
#########################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
OR1 =dataset$OR1[i]
samplesize=500
# dataset$corr[i]
dataset[i,]
# control group
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2
s3_group0 = p0_ce-p0_e1
s4_group0 = 1- p0_ce
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
# intervention group
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)
s4_group1 = 1- p1_ce
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
sm = (sm0+sm1)
corr_est =(sm[1]*sm[4]-(sm[2]*sm[3]))/sqrt((sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4]))
(corr_est)
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
OR1 =dataset$OR1[i]
samplesize=500
# dataset$corr[i]
dataset[i,]
# control group
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2
s3_group0 = p0_ce-p0_e1
s4_group0 = 1- p0_ce
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
# intervention group
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)
s4_group1 = 1- p1_ce
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
sm = (sm0+sm1)
(corr_est0)
sm = (sm0+sm1)
phat_e1 = (sm[1]+sm[2])/ss
phat_e1
ss=500
phat_e1 = (sm[1]+sm[2])/ss
phat_e1
phat_e2 = (sm[3]+sm[4])/ss
phat_int = (sm[1])/ss
corrhat = (phat_int-phat_e1*phat_e2)/sqrt(phat_e1*(1-phat_e1)*phat_e2*(1-phat_e2))
phat_e1
phat_e2
sm[3]
ss=1000
phat_e1 = (sm[1]+sm[2])/ss
phat_e2 = (sm[3]+sm[4])/ss
phat_int = (sm[1])/ss
corrhat = (phat_int-phat_e1*phat_e2)/sqrt(phat_e1*(1-phat_e1)*phat_e2*(1-phat_e2))
corrhat
phat_e1
phat_e2 = (sm[3]+sm[4])/ss
phat_int = (sm[1])/ss
corrhat = (phat_int-phat_e1*phat_e2)/sqrt(phat_e1*(1-phat_e1)*phat_e2*(1-phat_e2))
View(dataset)
dataset$OR_ce = (dataset$p1_ce/(1-dataset$p1_ce))/(dataset$p0_ce/(1-dataset$p0_ce))
View(dataset)
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
OR1 =dataset$OR1[i]
samplesize=500
# dataset$corr[i]
OR2 =dataset$OR2[i]
OR_ce=dataset$OR_ce[i]
dataset[i,]
# control group
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2
s3_group0 = p0_ce-p0_e1
s4_group0 = 1- p0_ce
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
# intervention group
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)
s4_group1 = 1- p1_ce
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
phat_e1 = (sm[1]+sm[2])/ss
phat_e2 = (sm[3]+sm[4])/ss
phat_ce = 1-(sm[4])/ss
phat0_e1 = fun_p0(p=phat_e1,l=OR1)
phat0_e2 = fun_p0(p=phat_e2,l=OR2)
phat0_ce = fun_p0(p=phat_ce,l=OR_ce)
phat0_e1
dataset[i,]
phat0_e1 = fun_p0(p=phat_e1,l=OR1)
phat0_e2 = fun_p0(p=phat_e2,l=OR2)
phat0_ce = fun_p0(p=phat_ce,l=OR_ce)
phat0_e1
phat0_e2
phat0_ce
sm
##############################################################
i=78
p0_e1 = dataset$p0_e1[i]
p1_e1 = dataset$p1_e1[i]
p0_e2 = dataset$p0_e2[i]
p1_e2 = dataset$p1_e2[i]
p0_ce = dataset$p0_ce[i]
p1_ce = dataset$p1_ce[i]
OR1 =dataset$OR1[i]
samplesize=500
# dataset$corr[i]
OR2 =dataset$OR2[i]
OR_ce=dataset$OR_ce[i]
dataset[i,]
# control group
s1_group0 = p0_e1 + p0_e2 - p0_ce
s2_group0 = p0_ce-p0_e2
s3_group0 = p0_ce-p0_e1
s4_group0 = 1- p0_ce
sm0 = rmultinom(1,500,c(s1_group0,s2_group0,s3_group0,s4_group0))
corr_est0 =(sm0[1]*sm0[4]-(sm0[2]*sm0[3]))/sqrt((sm0[1]+sm0[3])*(sm0[2]+sm0[4])*(sm0[1]+sm0[2])*(sm0[3]+sm0[4]))
(corr_est0)
# intervention group
s1_group1 = p1_e1+p1_e2-p1_ce
s2_group1 = ifelse(p1_ce-p1_e2>0, p1_ce-p1_e2, 0)
s3_group1 = ifelse(p1_ce-p1_e1>0, p1_ce-p1_e1, 0)
s4_group1 = 1- p1_ce
sm1 = rmultinom(1,500,c(s1_group1,s2_group1,s3_group1,s4_group1))
corr_est1 =(sm1[1]*sm1[4]-(sm1[2]*sm1[3]))/sqrt((sm1[1]+sm1[3])*(sm1[2]+sm1[4])*(sm1[1]+sm1[2])*(sm1[3]+sm1[4]))
(corr_est1)
sm = (sm0+sm1)
corr_est =(sm[1]*sm[4]-(sm[2]*sm[3]))/sqrt((sm[1]+sm[3])*(sm[2]+sm[4])*(sm[1]+sm[2])*(sm[3]+sm[4]))
(corr_est)
phat_e1 = (sm[1]+sm[2])/ss
phat_e2 = (sm[3]+sm[4])/ss
phat_ce = 1-(sm[4])/ss
phat0_e1 = fun_p0(p=phat_e1,l=OR1)
phat0_e2 = fun_p0(p=phat_e2,l=OR2)
phat0_ce = fun_p0(p=phat_ce,l=OR_ce)
phat0_e1
dataset[i,]
phat0_e2
phat0_ce
phat_e1
fun_p0 <- function(p,l){
p = p*2
sol1= -(1 + l + p - l*p + sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
sol2= -(1 + l + p - l*p - sqrt(4*(-1 + l)*p + (1 + l + p - l*p)^2))/(2*(-1 + l))
if(sol2>0 & sol2<1){
p0=sol2
}else{
p0=sol1
}
return(p0)
}
# p=p1_e1+p0_e1
# l=OR1
#
# fun_p0(p=p,l=l)
phat_e1 = (sm[1]+sm[2])/ss
phat_e2 = (sm[3]+sm[4])/ss
phat_ce = 1-(sm[4])/ss
phat0_e1 = fun_p0(p=phat_e1,l=OR1)
phat0_e2 = fun_p0(p=phat_e2,l=OR2)
phat0_ce = fun_p0(p=phat_ce,l=OR_ce)
phat0_e1
dataset[i,]
phat0_e1
phat0_e2
phat0_ce
phat_e1 = (sm[1]+sm[2])/ss
phat_e2 = (sm[1]+sm[3])/ss
phat_ce = 1-(sm[4])/ss
phat0_e1 = fun_p0(p=phat_e1,l=OR1)
phat0_e2 = fun_p0(p=phat_e2,l=OR2)
phat0_ce = fun_p0(p=phat_ce,l=OR_ce)
dataset[i,]
phat0_e1
phat0_e2
phat0_ce
corrhat = ((phat0_e1+phat0_e2-phat0_ce)-phat0_e1*phat0_e2)/sqrt(phat0_e1*(1-phat0_e1)*phat0_e2*(1-phat0_e2))
corrhat
ARE_up = ARE_cbe(p0_e1=phat0_e1, p0_e2=phat0_e2, eff_e1=OR1, eff_e2=OR2, rho=corrhat)
install_github("CompARE-Composite/CompARE-package")
library(CompARE)
#######################################
library(tidyverse)
library(tidyr)
library(plyr)
library(devtools)
install_github("CompARE-Composite/CompARE-package")
library(CompARE)
library(tidyverse)
library(CompARE)
ARE_up = ARE_cbe(p0_e1=phat0_e1, p0_e2=phat0_e2, eff_e1=OR1, eff_e2=OR2, rho=corrhat)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
remove.packages(tidyverse)
remove.packages(tidyverse,'C:/Users/mbofi/Documents/R/win-library/4.0/Rcpp/libs/x64/Rcpp.dll')
remove.packages(pkgs='tidyverse','C:/Users/mbofi/Documents/R/win-library/4.0/Rcpp/libs/x64/Rcpp.dll')
remove.packages(pkgs='tidyverse',lib='C:/Users/mbofi/Documents/R/win-library/4.0/Rcpp/libs/x64/Rcpp.dll')
library(tidyverse)
remove.packages("tidyverse", lib="~/R/win-library/4.0")
remove.packages("tidyr", lib="~/R/win-library/4.0")
remove.packages("plyr", lib="~/R/win-library/4.0")
remove.packages("devtools", lib="~/R/win-library/4.0")
remove.packages("CompARE", lib="~/R/win-library/4.0")
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
